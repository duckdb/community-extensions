extension:
  name: func_apply
  description: Dynamic function invocation - call any scalar function or macro by name at runtime
  version: 0.1.0
  language: C++
  build: cmake
  license: MIT
  maintainers:
    - teaguesterling

repo:
  github: teaguesterling/duckdb_func_apply
  ref: 62fe7358a6bf50ce8a0a9e3ade59011af88cb422

docs:
  hello_world: |
    -- Call functions dynamically by name
    SELECT apply('upper', 'hello world');
    -- Result: HELLO WORLD

    -- Works with any scalar function
    SELECT apply('abs', -42);
    -- Result: 42

    -- Call macros too
    SELECT apply('list_sum', [1, 2, 3, 4]);
    -- Result: 10

    -- Check if a function exists
    SELECT function_exists('upper'), function_exists('nonexistent');
    -- Result: true, false

  extended_description: |
    The FuncApply extension enables dynamic function invocation in DuckDB, allowing you to
    call any scalar function or macro by name at runtime. This is useful for data-driven
    transformations, dynamic SQL generation, and building flexible data pipelines.

    ## Functions

    | Function | Description |
    |----------|-------------|
    | `apply(func_name, ...args)` | Call a function by name with arguments |
    | `apply_with(func_name, args)` | Call a function with arguments as a list |
    | `function_exists(name)` | Check if a function exists |

    ## Use Cases

    ### Data-Driven Transformations

    ```sql
    -- Store transformation rules in a table
    CREATE TABLE transforms (column_name VARCHAR, func_name VARCHAR);
    INSERT INTO transforms VALUES ('name', 'upper'), ('email', 'lower');

    -- Apply transformations dynamically
    SELECT apply(t.func_name, d.value) as result
    FROM data d JOIN transforms t ON d.column = t.column_name;
    ```

    ### Dynamic Function Selection

    ```sql
    -- Choose function based on data type
    SELECT apply(
        CASE typeof(value)
            WHEN 'VARCHAR' THEN 'upper'
            WHEN 'INTEGER' THEN 'abs'
        END,
        value
    ) FROM my_table;
    ```

    ## Supported Function Types

    - Scalar functions (e.g., `upper`, `abs`, `substr`)
    - Macros (e.g., `list_sum`, `list_reverse`)

    Aggregate and table functions are not supported.
