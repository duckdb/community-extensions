function,description,comment,example
read_alignments,"Read SAM/BAM alignment files as a table. Supports headerless SAM files with reference_lengths parameter, glob patterns, and parallel processing.","Also available as read_sam (alias)","SELECT * FROM read_alignments('alignments.bam');"
read_fastx,"Read FASTA/FASTQ sequence files as a table. Supports single-end and paired-end reads, glob patterns, gzip compression, and quality score offset conversion.","","SELECT * FROM read_fastx('reads.fastq.gz');"
read_biom,"Read BIOM (Biological Observation Matrix) format files. Returns sparse COO format with sample_id, feature_id, and value columns.","HDF5-based BIOM v2.1 format","SELECT * FROM read_biom('ogu_table.biom');"
read_gff,"Read GFF3 annotation files. Parses attributes column into a SQL MAP for easy querying.","","SELECT type, attributes['gene'] AS gene FROM read_gff('annotations.gff');"
read_ncbi,"Fetch GenBank metadata from NCBI by accession number. Returns organism, length, taxonomy_id, and other metadata.","Requires httpfs extension","SELECT * FROM read_ncbi('NC_000913.3');"
read_ncbi_fasta,"Fetch FASTA sequences from NCBI by accession number. Returns data in read_fastx-compatible schema.","Requires httpfs extension","SELECT * FROM read_ncbi_fasta('NC_000913.3');"
read_ncbi_annotation,"Fetch feature annotations from NCBI by accession number. Returns data in read_gff-compatible schema.","Requires httpfs extension","SELECT * FROM read_ncbi_annotation('NC_000913.3') WHERE type = 'gene';"
read_jplace,"Read jplace phylogenetic placement files. Returns best placement per fragment with edge_num, likelihood, and like_weight_ratio.","","SELECT fragment, edge_num, like_weight_ratio FROM read_jplace('placements.jplace');"
read_newick,"Read Newick phylogenetic tree files. Returns one row per node with parent-child relationships and branch lengths.","","SELECT name, branch_length FROM read_newick('tree.nwk') WHERE is_tip;"
align_minimap2,"Align query sequences to subject sequences using minimap2. Supports pre-built indexes for 10-30x performance improvement.","","SELECT * FROM align_minimap2('queries', subject_table='subjects');"
save_minimap2_index,"Build and save a minimap2 index to disk for reuse with align_minimap2.","","SELECT * FROM save_minimap2_index('subjects', 'refs.mmi', preset='sr');"
align_bowtie2,"Align query sequences to subject sequences using Bowtie2. Optimized for short reads.","Requires bowtie2 in PATH","SELECT * FROM align_bowtie2('queries', 'subjects', preset='very-sensitive');"
alignment_is_paired,"Test if read is paired (SAM flag 0x1).","","SELECT * FROM read_alignments('a.bam') WHERE alignment_is_paired(flags);"
alignment_is_proper_pair,"Test if read is properly paired (SAM flag 0x2).","","SELECT * FROM read_alignments('a.bam') WHERE alignment_is_proper_pair(flags);"
alignment_is_unmapped,"Test if read is unmapped (SAM flag 0x4).","","SELECT * FROM read_alignments('a.bam') WHERE NOT alignment_is_unmapped(flags);"
alignment_is_mate_unmapped,"Test if mate is unmapped (SAM flag 0x8).","","SELECT * FROM read_alignments('a.bam') WHERE alignment_is_mate_unmapped(flags);"
alignment_is_reverse,"Test if read is on reverse strand (SAM flag 0x10).","","SELECT * FROM read_alignments('a.bam') WHERE alignment_is_reverse(flags);"
alignment_is_mate_reverse,"Test if mate is on reverse strand (SAM flag 0x20).","","SELECT * FROM read_alignments('a.bam') WHERE alignment_is_mate_reverse(flags);"
alignment_is_read1,"Test if read is first in pair (SAM flag 0x40).","","SELECT * FROM read_alignments('a.bam') WHERE alignment_is_read1(flags);"
alignment_is_read2,"Test if read is second in pair (SAM flag 0x80).","","SELECT * FROM read_alignments('a.bam') WHERE alignment_is_read2(flags);"
alignment_is_secondary,"Test if alignment is secondary (SAM flag 0x100).","","SELECT * FROM read_alignments('a.bam') WHERE NOT alignment_is_secondary(flags);"
alignment_is_primary,"Test if alignment is primary (neither secondary nor supplementary).","","SELECT * FROM read_alignments('a.bam') WHERE alignment_is_primary(flags);"
alignment_is_qc_failed,"Test if read failed QC (SAM flag 0x200).","","SELECT * FROM read_alignments('a.bam') WHERE NOT alignment_is_qc_failed(flags);"
alignment_is_duplicate,"Test if read is PCR/optical duplicate (SAM flag 0x400).","","SELECT * FROM read_alignments('a.bam') WHERE NOT alignment_is_duplicate(flags);"
alignment_is_supplementary,"Test if alignment is supplementary (SAM flag 0x800).","","SELECT * FROM read_alignments('a.bam') WHERE NOT alignment_is_supplementary(flags);"
alignment_seq_identity,"Calculate sequence identity between read and reference. Supports gap_compressed (default), gap_excluded, and blast methods.","","SELECT alignment_seq_identity(cigar, tag_nm, tag_md) FROM read_alignments('a.bam');"
alignment_query_length,"Calculate total query length from a CIGAR string. Optionally includes hard-clipped bases.","","SELECT alignment_query_length(cigar) FROM read_alignments('a.bam');"
alignment_query_coverage,"Calculate proportion of query bases covered by alignment. Supports 'aligned' (default) and 'mapped' types.","","SELECT alignment_query_coverage(cigar) FROM read_alignments('a.bam');"
sequence_dna_reverse_complement,"Calculate reverse complement of DNA sequences. Supports IUPAC ambiguity codes and preserves case.","","SELECT sequence_dna_reverse_complement('ATCG');"
sequence_rna_reverse_complement,"Calculate reverse complement of RNA sequences. Supports IUPAC ambiguity codes and preserves case.","","SELECT sequence_rna_reverse_complement('AUCG');"
sequence_dna_as_regexp,"Convert DNA sequences with IUPAC codes to regular expression patterns for pattern matching.","","SELECT sequence_dna_as_regexp('ATNGG');"
sequence_rna_as_regexp,"Convert RNA sequences with IUPAC codes to regular expression patterns for pattern matching.","","SELECT sequence_rna_as_regexp('AUNGG');"
compress_intervals,"Aggregate function that merges overlapping genomic intervals into a minimal set of non-overlapping intervals.","","SELECT reference, compress_intervals(position, stop_position) FROM read_alignments('a.bam') GROUP BY reference;"
woltka_ogu_per_sample,"Compute Woltka OGU counts over alignment data for multiple samples. Accounts for multi-mapped reads.","Macro - do not quote parameters","SELECT * FROM woltka_ogu_per_sample(alignments, sample_id, read_id);"
woltka_ogu,"Compute Woltka OGU counts over alignment data for a single sample. Accounts for multi-mapped reads.","Macro - do not quote parameters","SELECT * FROM woltka_ogu(alignments, read_id);"
