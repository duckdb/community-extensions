extension:
  name: onelake
  description: This extension allows you to connect DuckDB to Microsoft Fabric OneLake workspaces and lakehouses, enabling you to query data stored in OneLake directly from DuckDB.
  version: 1.0.0
  language: C++
  build: cmake
  license: MIT
  maintainers:
    - achrafcei
repo:
  github: datumnova/duckdb_onelake.git
  ref: a3bd9d89eff2f80aed230a74fb538d29e9b2e41f
  canonical_name: onelake

docs:
  hello_world: |
    -- First, create a secret to authenticate with OneLake.
    -- You can use either a service principal or the credential chain (e.g., Azure CLI).
    -- Uncomment the desired method and provide the necessary credentials.
    set azure_transport_option_type = 'curl';
    CREATE SECRET  (
        TYPE azure,
        PROVIDER service_principal,
        TENANT_ID '<your_tenant_id>',
        CLIENT_ID '<your_client_id>',
        CLIENT_SECRET '<your_client_secret>'
    );
    -- CREATE SECRET  (
    --     TYPE azure,
    --     PROVIDER credential_chain,
    --     CHAIN 'cli'
    -- );

    CREATE SECRET onelake (
        TYPE ONELAKE,
        TENANT_ID '<your_tenant_id>',
        CLIENT_ID '<your_client_id>',
        CLIENT_SECRET '<your_client_secret>'
    );

    -- CREATE SECRET  onelake(
    --     TYPE ONELAKE,
    --     PROVIDER credential_chain,
    --     CHAIN 'cli'
    -- );

    -- Attach to your OneLake workspace and lakehouse
    -- You can provide either IDs or names for the workspace and lakehouse.
    -- If you wish to only attach to a workspace without specifying a default lakehouse, omit the DEFAULT_LAKEHOUSE parameter.
    -- If you however wish to only connect to a specific lakehouse run only the second ATTACH command below.

    ATTACH 'onelake://<your_workspace_id>'
          AS <your_connection_name>
          (TYPE ONELAKE, DEFAULT_LAKEHOUSE '<your_lakehouse_id_or_name>');

    -- Alternatively, provide workspace and lakehouse names and let the extension resolve them:
    ATTACH '<your_workspace_name>/<your_lakehouse_name>.Lakehouse'
        AS <your_connection_name>
        (TYPE ONELAKE);

    USE <your_connection_name>;

    SHOW TABLES;

    SELECT * FROM <your_table_name> LIMIT 10 ; -- USING ICEBERG;

   


  extended_description: |
    This extension enables DuckDB to connect to Microsoft Fabric OneLake workspaces and lakehouses, allowing users to query data stored in OneLake directly from DuckDB. 
    It supports authentication via service principals or credential chains (e.g., Azure CLI) and provides seamless integration with OneLake's data storage capabilities.
    For detailed setup and usage instructions, visit the [extension repository](https://github.com/datumnova/duckdb_onelake).
    Current limitations:
    - Only read access is supported; write operations are not yet implemented.
    - Schema enabled lakehouses are not supported.


